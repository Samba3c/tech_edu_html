<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è‹±æ–‡éµç›¤éŠæˆ²</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background-color: #f4f4f4;
            margin: 0;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }

        .keyboard {
            text-align: center;
            margin-top: 20px;
            display: none; /* é è¨­éš±è—éµç›¤ */
        }

        .row {
            display: flex;
            justify-content: center;
            margin-bottom: 5px;
        }

        .key {
            width: 80px;
            height: 80px;
            margin: 3px;
            background-color: #ddd;
            border: 1px solid #ccc;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 36px;
            cursor: pointer;
            user-select: none;
            transition: background-color 0.2s;
        }

        .key.active {
            background-color: green;
            animation: flash 0.3s infinite alternate;
        }

        .key[data-key="1"] {
            background-color: #FFB5B5; /*  æŒ‰éµ1 è®Šè‰² */
        }
        .key[data-key="Q"] {
            background-color: #FFB5B5; 
        }
        .key[data-key="A"] {
            background-color: #FFB5B5; 
        }
        .key[data-key="Z"] {
            background-color: #FFB5B5; 
        }
        .key[data-key="2"] {
            background-color: #FFE4CA	; 
        }
        .key[data-key="W"] {
            background-color: #FFE4CA	; 
        }
        .key[data-key="S"] {
            background-color: #FFE4CA	; 
        }
        .key[data-key="X"] {
            background-color: #FFE4CA	; 
        }
        .key[data-key="3"] {
            background-color: #FFFFCE	; 
        }
        .key[data-key="E"] {
            background-color: #FFFFCE	; 
        }
        .key[data-key="D"] {
            background-color: #FFFFCE	; 
        }
        .key[data-key="C"] {
            background-color: #FFFFCE	; 
        }
        .key[data-key="8"] {
            background-color: #FFFFCE	; 
        }
        .key[data-key="I"] {
            background-color: #FFFFCE	; 
        }
        .key[data-key="K"] {
            background-color: #FFFFCE	; 
        }
        .key[data-key=","] {
            background-color: #FFFFCE	; 
        }
        .key[data-key="0"] {
            background-color: #FFB5B5; /*  æŒ‰éµ0 è®Šè‰² */
        }
        .key[data-key="P"] {
            background-color: #FFB5B5; 
        }
        .key[data-key="L"] {
            background-color: #FFECEC	; 
        }
        .key[data-key="9"] {
            background-color: #FFE4CA	; 
        }
        .key[data-key="O"] {
            background-color: #FFE4CA	; 
        }
        .key[data-key="L"] {
            background-color: #FFE4CA	; 
        }
        .key[data-key="."] {
            background-color: #FFE4CA	; 
        }
        .key[data-key="7"] {
            background-color: #BEBEBE	; 
        }
        .key[data-key="U"] {
            background-color: #BEBEBE	; 
        }
        .key[data-key="J"] {
            background-color: #BEBEBE	; 
        }
        .key[data-key="M"] {
            background-color: #BEBEBE	; 
        }
        .key[data-key="6"] {
            background-color: #BEBEBE	; 
        }
        .key[data-key="Y"] {
            background-color: #BEBEBE	; 
        }
        .key[data-key="H"] {
            background-color: #BEBEBE	; 
        }
        .key[data-key="N"] {
            background-color: #BEBEBE	; 
        }
        .key[data-key="|"] {
            background-color: #FFECEC; /* backspace æŒ‰éµè‰² */
            width: 80px;
        }

        .key.error {
            background-color: red;/* éŒ¯èª¤æŒ‰éµè®Šç´…è‰² */
        }


        /* Special styles for the F and J keys */
        .key[data-key="F"], .key[data-key="J"] {
            font-weight: bold;
            text-decoration: underline;
        }

        #current-key {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        #score, #timer, #result {
            font-size: 20px;
            margin-top: 10px;
        }

        #stars {
            font-size: 24px;
            margin-top: 10px;
        }

        #restart-btn {
            display: none;
            margin-top: 15px;
            padding: 10px 20px;
            font-size: 18px;
            cursor: pointer;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
        }

        #restart-btn:hover {
            background-color: #45a049;
        }

        @keyframes flash {
            0% {
                background-color: green;
            }
            100% {
                background-color: lightgreen;
            }
        }

        .mode-btn {
            margin: 10px;
            padding: 10px 20px;
            font-size: 18px;
            cursor: pointer;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
        }

        .mode-btn:hover {
            background-color: #45a049;
        }

        #game-mode {
            font-size: 20px;
            margin-top: 10px;
        }
        #target-key {
            color: blue;
        }
        /* æ–°å¢çš„ CSSï¼Œéš±è—åˆå§‹é¡¯ç¤ºçš„å…ƒç´  */
        #current-key, #score, #timer {
            display: none;
        }
    </style>
</head>
<body>

<h1>è‹±æ–‡å­—æ¯éµç›¤éŠæˆ²</h1>
<p id="mode-warning" style="font-size: 18px; color: red; font-weight: bold;">
    å¿…é ˆé¸æ“‡æ‰“å­—æ¨¡å¼å¾Œï¼Œæ‰èƒ½é–‹å§‹æ‰“å­—ï¼
</p>
<div id="mode-buttons">
    <button class="mode-btn" id="mode60">60 ç§’æŒ‘æˆ°æ¨¡å¼</button>
    <button class="mode-btn" id="mode10">10 ç§’æš–èº«</button>
    <button class="mode-btn" id="mode90">90 ç§’ç·´ç¿’æ¨¡å¼</button> <!-- æ–°å¢ 90 ç§’æ¨¡å¼ -->
</div>

<!-- éŠæˆ²è³‡è¨Šï¼Œé–‹å§‹å‰éš±è— -->
<div id="current-key">è«‹æŒ‰ä¸‹ï¼š<span id="target-key"></span></div>
<div id="score">å¾—åˆ†ï¼š0</div>
<div id="timer">å‰©é¤˜æ™‚é–“ï¼š60 ç§’</div>
<div id="result"></div>
<div id="stars"></div>
<div id="game-mode"></div> <!-- é¡¯ç¤ºé¸æ“‡çš„éŠæˆ²æ¨¡å¼ -->

<div class="keyboard">
    <div class="row">
        <div class="key" data-key="1">1</div>
        <div class="key" data-key="2">2</div>
        <div class="key" data-key="3">3</div>
        <div class="key" data-key="4">4</div>
        <div class="key" data-key="5">5</div>
        <div class="key" data-key="6">6</div>
        <div class="key" data-key="7">7</div>
        <div class="key" data-key="8">8</div>
        <div class="key" data-key="9">9</div>
        <div class="key" data-key="0">0</div>
        <div class="key" data-key="|">â¬…ï¸</div>        
    </div>

    <div class="row">
        <div class="key" data-key="Q">Q</div>
        <div class="key" data-key="W">W</div>
        <div class="key" data-key="E">E</div>
        <div class="key" data-key="R">R</div>
        <div class="key" data-key="T">T</div>
        <div class="key" data-key="Y">Y</div>
        <div class="key" data-key="U">U</div>
        <div class="key" data-key="I">I</div>
        <div class="key" data-key="O">O</div>
        <div class="key" data-key="P">P</div>
    </div>

    <div class="row">
        <div class="key" data-key="A">A</div>
        <div class="key" data-key="S">S</div>
        <div class="key" data-key="D">D</div>
        <div class="key" data-key="F">F</div>
        <div class="key" data-key="G">G</div>
        <div class="key" data-key="H">H</div>
        <div class="key" data-key="J">J</div>
        <div class="key" data-key="K">K</div>
        <div class="key" data-key="L">L</div>
    </div>

    <div class="row">
        <div class="key" data-key="Z">Z</div>
        <div class="key" data-key="X">X</div>
        <div class="key" data-key="C">C</div>
        <div class="key" data-key="V">V</div>
        <div class="key" data-key="B">B</div>
        <div class="key" data-key="N">N</div>
        <div class="key" data-key="M">M</div>
    </div>
</div>
<button id="restart-btn" onclick="restartGame()">é‡æ–°é¸æ“‡</button>

<script>
    let score = 0;
    let keyPressCount = 0;
    let timeLeft = 60;
    let timerStarted = false;
    let timerInterval;
    let currentKey;
    let gameMode = 60;
    let previousKeys = [];  // ç”¨ä¾†è¨˜éŒ„å‰äº”æ¬¡çš„é¡Œç›®
    let selectedMode = "";  // ç”¨ä¾†å„²å­˜é¸æ“‡çš„æ¨¡å¼åç¨±
    let gameEnded = false;  // æ–°å¢è®Šæ•¸ä»¥åˆ¤æ–·éŠæˆ²æ˜¯å¦çµæŸ

    // é€šç”¨çš„åˆå§‹åŒ–å‡½æ•¸
    function resetGameVariables() {
        score = 0;
        keyPressCount = 0;
        timeLeft = gameMode;
        previousKeys = [];  // é‡ç½®å‰äº”æ¬¡çš„é¡Œç›®è¨˜éŒ„
        timerStarted = false;
        gameEnded = false;  // é‡ç½®éŠæˆ²çµæŸç‹€æ…‹

        // æ›´æ–°é¡¯ç¤º
        document.getElementById('score').textContent = `å¾—åˆ†ï¼š${score}`;
        document.getElementById('timer').textContent = `å‰©é¤˜æ™‚é–“ï¼š${timeLeft} ç§’`;
        document.getElementById('result').textContent = "";
        document.getElementById('stars').textContent = "";
        document.getElementById('restart-btn').style.display = 'none';
        document.getElementById('game-mode').textContent = `éŠæˆ²æ¨¡å¼ï¼š${selectedMode}`; // é¡¯ç¤ºé¸æ“‡çš„æ¨¡å¼
        document.getElementById('mode-warning').style.display = 'none'; // éš±è—è­¦å‘Šè¨Šæ¯
    }

    function getRandomKey() {
        const keys = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
        let newKey;

        // ç¢ºä¿æ–°é¡Œç›®ä¸å’Œä¸Šä¸€å€‹ç›¸åŒ
        do {
            newKey = keys[Math.floor(Math.random() * keys.length)];
        } while (newKey === currentKey || previousKeys.includes(newKey));

        // æ›´æ–°å‰äº”æ¬¡é¡Œç›®è¨˜éŒ„
        if (previousKeys.length >= 5) {
            previousKeys.shift();  // è¶…é5å€‹é¡Œç›®æ™‚ï¼Œåˆªé™¤æœ€èˆŠçš„ä¸€å€‹
        }
        previousKeys.push(newKey);

        return newKey;
    }

    function highlightKey(key) {
        document.querySelectorAll('.key').forEach(k => k.classList.remove('active', 'error'));
        const keyElement = document.querySelector(`.key[data-key="${key}"]`);
        if (keyElement) keyElement.classList.add('active');
        document.getElementById('target-key').textContent = key;
    }

    function startTimer() {
        timerInterval = setInterval(() => {
            timeLeft--;
            document.getElementById('timer').textContent = `å‰©é¤˜æ™‚é–“ï¼š${timeLeft} ç§’`;
            if (timeLeft <= 0) {
                clearInterval(timerInterval);
                endGame();
            }
        }, 1000);
    }

    function endGame() {
        gameEnded = true;  // æ¨™è¨˜éŠæˆ²çµæŸ
        document.removeEventListener('keydown', handleKeyPress);  // ç§»é™¤éµç›¤äº‹ä»¶
        document.getElementById('result').textContent = `è¼¸å…¥æ¬¡æ•¸ï¼š${keyPressCount}`;
        document.getElementById('stars').innerHTML = getStarRating(score);
        document.getElementById('restart-btn').style.display = 'block';

        // éš±è—éµç›¤
        document.querySelector('.keyboard').style.display = 'none';
    }

    function getStarRating(score) {
        let stars = Math.min(7, Math.floor(score / 10));
        let starText = "â­".repeat(stars) || "ğŸ˜";
        let feedback = ["ä¸è¦ç°å¿ƒï¼Œå¾€ 1 æ˜Ÿé‚é€²ï¼Œç¹¼çºŒåŠ æ²¹ï¼", "ä½ æ˜¯ 1 æ˜Ÿçš„æ–°æ‰‹æˆ°å£«ï¼Œé–‹å§‹åŠªåŠ›å§ï¼", "é€²å…¥ 2 æ˜Ÿå‹‡å£«äº†ï¼Œå†è¡å°±å°äº†ï¼", "ä¸éŒ¯å–”ï¼æ™‰å‡ç‚º 3 æ˜Ÿé¨å£«äº†ï¼", "è®šå•¦ï¼ä½ æ˜¯ 4 æ˜Ÿé«˜æ‰‹ï¼Œè¶…å¼·çš„ï¼", "å¤ªå²å®³äº†ï¼ä½ æ˜¯ 5 æ˜Ÿè‹±é›„å–”ï¼", "å¼·å¤§çš„ 6 æ˜Ÿå¤§å¸«ï¼", "å¤©å“ªï¼ Power 7 æ˜Ÿå¤§ç¥ï¼"][stars];
        return `${starText} ${feedback}`;
    }

    function restartGame() {
        location.reload();  // é‡æ–°æ•´ç†ç¶²é 
    }

    function handleKeyPress(event) {
        if (!timerStarted) {
            timerStarted = true;
            startTimer();

            // é¡¯ç¤ºéŠæˆ²è³‡è¨Š
            document.getElementById('current-key').style.display = 'block';
            document.getElementById('score').style.display = 'block';
            document.getElementById('timer').style.display = 'block';
        }

        if (gameEnded) return;  // éŠæˆ²çµæŸå¾Œåœæ­¢éµç›¤äº‹ä»¶

        const keyValue = event.key.toUpperCase();
        if (!/^[A-Z0-9]$/.test(keyValue)) return;

        keyPressCount++;

        if (keyValue === currentKey) {
            score++;
            currentKey = getRandomKey();
            highlightKey(currentKey);
        } else {
            if (score > 0) {
                score--;  // æ‰“éŒ¯å­—ï¼Œæ‰£1åˆ†ï¼Œä½†ä¸ä½æ–¼0
            }
            const keyElement = document.querySelector(`.key[data-key="${keyValue}"]`);
            if (keyElement) keyElement.classList.add('error');
            setTimeout(() => keyElement.classList.remove('error'), 300); //éŒ¯èª¤æ¡ˆä»¶æ¢å¾©åŸè‰²
        }

        document.getElementById('score').textContent = `å¾—åˆ†ï¼š${score}`;
    }

    // æŒ‰éˆ•äº‹ä»¶è™•ç†
    document.getElementById('mode60').addEventListener('click', () => {
        gameMode = 60;
        selectedMode = "60 ç§’æŒ‘æˆ°æ¨¡å¼";  // è¨˜éŒ„é¸æ“‡çš„æ¨¡å¼
        resetGameVariables();
        currentKey = getRandomKey();
        highlightKey(currentKey);
        document.querySelector('.keyboard').style.display = 'block';  // é¡¯ç¤ºéµç›¤
        document.getElementById('mode-buttons').style.display = 'none';  // éš±è—æ¨¡å¼é¸æ“‡æŒ‰éˆ•
        document.getElementById('current-key').style.display = 'block'; // é¡¯ç¤ºâ€œè«‹æŒ‰ä¸‹â€
        document.getElementById('score').style.display = 'block'; // é¡¯ç¤ºå¾—åˆ†
        document.getElementById('timer').style.display = 'block'; // é¡¯ç¤ºå‰©é¤˜æ™‚é–“
        document.getElementById('game-mode').style.display = 'block';  // é¡¯ç¤ºé¸æ“‡çš„æ¨¡å¼
        document.addEventListener('keydown', handleKeyPress);
    });

    document.getElementById('mode10').addEventListener('click', () => {
        gameMode = 10;
        selectedMode = "10 ç§’æš–èº«";
        resetGameVariables();
        currentKey = getRandomKey();
        highlightKey(currentKey);
        document.querySelector('.keyboard').style.display = 'block';
        document.getElementById('mode-buttons').style.display = 'none';
        document.getElementById('current-key').style.display = 'block';
        document.getElementById('score').style.display = 'block';
        document.getElementById('timer').style.display = 'block';
        document.getElementById('game-mode').style.display = 'block';
        document.addEventListener('keydown', handleKeyPress);
    });

    document.getElementById('mode90').addEventListener('click', () => {  // æ–°å¢ 90 ç§’æ¨¡å¼
        gameMode = 90;
        selectedMode = "90 ç§’ç·´ç¿’æ¨¡å¼";
        resetGameVariables();
        currentKey = getRandomKey();
        highlightKey(currentKey);
        document.querySelector('.keyboard').style.display = 'block';
        document.getElementById('mode-buttons').style.display = 'none';
        document.getElementById('current-key').style.display = 'block';
        document.getElementById('score').style.display = 'block';
        document.getElementById('timer').style.display = 'block';
        document.getElementById('game-mode').style.display = 'block';
        document.addEventListener('keydown', handleKeyPress);
    });
</script>
ç¨‹å¼ä½œè€…ï¼šé˜¿é‚¦è€å¸« Ver.20250311
</body>
</html>
